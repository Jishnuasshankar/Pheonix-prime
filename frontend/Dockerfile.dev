# ==============================================================================
# MasterX Frontend - Development Dockerfile
# ==============================================================================
FROM node:20-alpine

LABEL maintainer="MasterX Team"
LABEL description="MasterX Frontend - Development Runtime"

WORKDIR /app

# ------------------------------------------------------------------------------
# FIX 1: Install curl for Healthchecks
# Alpine doesn't have it by default.
# ------------------------------------------------------------------------------
RUN apk add --no-cache curl

# Copy package files
COPY package.json yarn.lock ./

# Install dependencies
RUN yarn install --frozen-lockfile

# Copy code
COPY . .

# Expose port
EXPOSE 3000

# Environment variables
ENV NODE_ENV=development \
    CHOKIDAR_USEPOLLING=true

# ------------------------------------------------------------------------------
# CHECK THIS: Ensure 'start' script in package.json runs "vite" (dev server),
# NOT "vite preview" or "react-scripts start".
# If your package.json has "dev": "vite", change this CMD to ["yarn", "dev"]
# ------------------------------------------------------------------------------
CMD ["yarn", "start"]